<!DOCTYPE html>
<!--
All of the patterns are generated by http://www.stripegenerator.com/index.php?page=index#Zm9yZT1mZjAwMDA7aD0zMDt3PTM7cD0zO2JhY2sxPWZmZmZmZjtiYWNrMj1mZjAwMDA7Z3Q9MDtkPTA7c2hhZG93PTA7
By Maziar Aboualizadeh, contact me at mbooali@gmail.com
-->
<html>

<head>
  <meta charset="utf-8">
  <title></title>
  <script src="js/jquery-1.11.3.min.js" charset="utf-8"></script>
  <script src="js/bootstrap.min.js" charset="utf-8"></script>
  <link rel="stylesheet" href="css/bootstrap.css" media="screen" title="no title" charset="utf-8">
  <link rel="stylesheet" href="css/bootstrap-theme.css" media="screen" title="no title" charset="utf-8">

  <script type="text/javascript">
    var running = null;
    function only_binary(event) {
      if (event.keyCode != 48 && event.keyCode != 49 && event.keyCode != 8 && event.keyCode != 13) {
        event.preventDefault();
        return false;
      }
    }

    function message_box_keypress_handler() {

      //can be commented out this function call if we want to
      only_binary(event);

      if (event.keyCode == 13) //Enter pressed
      {
        var message_value = $('#message')[0].value;
        message_decoder(message_value);
      }
    }

    function message_decoder(data) {  //decode message's bits into the pattern movement

      i = 0;
      var total_delay_between_bits = 1000;
      if(running != null)
      {
        clearInterval(running);
        console.log("restart periodic render function");
      }
      running = setInterval(  //each bit takes equal to "total_delay_between_bits" to be done
        function(){
          if(i >= 0 && i < data.length)
          {
            if(data[i] == '0')
            {
              $('#pattern-area').css('background-position', '-=50px 0px');
            }
            else if(data[i] == '1')
            {
              $('#pattern-area').css('background-position', '+=50px 0px');
            }
            i++;
          }
        }, total_delay_between_bits);
    }

    // function move_pattern(direction) {
    //   if(direction == '0'){   //move the pattern LEFT to simulate mouse moving RIGHT
    //     $('#pattern-area').delay( 800 ).css('background-position', '-50px 0px');
    //     console.log('move left');
    //   }
    //   else if(direction == '1'){  //move the pattern RIGHT to simulate mouse moving LEFT
    //     $('#pattern-area').delay( 800 ).css('background-position', '50px 0px');
    //     console.log('move right');
    //   }
    // }
    var current_pattern = 2;
    var total_number_patterns = 4;

    function load_next_pattern() {
      $(".pattern-area").css("background-image", "url('patterns/pattern" + ((current_pattern % total_number_patterns)+1) + ".png')");
      console.log("pattern" + ((current_pattern % total_number_patterns)+1) + ".png'");
      current_pattern++;
    }
  </script>
</head>

<body>
  <br>
  <h3>Enter Message and Hit Enter to Transfer</h3>
  <div style="margin-left: 20px">
    <label for="message">Message to transfer:</label>
    <input type="input" size="49" name="message" value="" onkeydown="message_box_keypress_handler()" id="message" placeholder="Only support Binary Input"></input>
    <br>
    <button type="button" name="next_pattern" class="btn" onclick="load_next_pattern()">Next Pattern!</button>
    <br><br><br>

    <div class="pattern-area" id="pattern-area">
    </div>
  </div>
</body>


<style media="screen">
  .pattern-area {
    width: 500px;
    height: 500px;
    background-position: 0px 0px;
    background-image: url("patterns/pattern1.png");
    -webkit-transition: background-position 0.5s ease;
    -moz-transition: background-position 0.5s ease;
    -o-transition: background-position 0.5s ease;
    transition: background-position 0.5s ease;
  }
</style>

</html>
